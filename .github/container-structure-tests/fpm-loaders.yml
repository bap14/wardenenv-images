schemaVersion: "2.0.0"

commandTests:
  - name: "PHP Exists"
    command: "which"
    args: ["php-fpm"]
    expectedOutput: ["/usr/bin/php-fpm"]
  - name: "PHP Module Check"
    command: "php-fpm"
    args: ["-m"]
    expectedOutput:
      - "(?m)SourceGuardian"
  - name: "PHP Info Check"
    command: "php-fpm"
    args: ["-i"]
    expectedOutput:
      - "/etc/php\\.d/15-sourceguardian.ini"
      - "(?m)^SourceGuardian Loader Support => enabled"
      - "(?m)^sourceguardian\\.enable_debug => 0 => 0"

fileExistenceTests:
  - name: "SourceGuardian Config"
    path: "/etc/php.d/15-sourceguardian.ini"
    shouldExist: true